<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Test : " />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Test</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/AlexandreToyer/test">View on GitHub</a>

          <h1 id="project_title">Test</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/AlexandreToyer/test/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/AlexandreToyer/test/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="crawler-un-site-internet-et-obtenir-un-moteur-de-recherche" class="anchor" href="#crawler-un-site-internet-et-obtenir-un-moteur-de-recherche"><span class="octicon octicon-link"></span></a>Crawler un site internet et obtenir un moteur de recherche</h1>

<p>Ce tutorial rapide à réaliser vous permettra de prendre en main certaines fonctionnalités d'OpenSearchServer. Vous apprendez à crawler un site pour construire l'index de recherche, mettre en place une page de recherche, configurer des facettes et activer l'auto-complétion !</p>

<p>Pour commencer ce tutorial il vous suffit simplement d'<a href="http://www.open-search-server.com/fr/tester-opensearchserver">Installer OpenSearchServer</a>.</p>

<p>Nous imaginerons ici que votre site Internet est un site d'actualités. Nous avons créé pour cela 4 pages fictives : XXXXXX</p>

<h2>
<a name="mise-en-place-du-crawl-et-indexation-des-contenus" class="anchor" href="#mise-en-place-du-crawl-et-indexation-des-contenus"><span class="octicon octicon-link"></span></a>Mise en place du crawl et indexation des contenus</h2>

<h3>
<a name="cr%C3%A9ation-et-configuration-initiale-de-lindex" class="anchor" href="#cr%C3%A9ation-et-configuration-initiale-de-lindex"><span class="octicon octicon-link"></span></a>Création et configuration initiale de l'index</h3>

<p>Commençons par créer un <code>index</code>. L'index est le cœur d'OpenSearchServer, c'est autour des index que le reste des fonctionnalités s'organisent. L'index permet de stocker et d'indexer tous les <strong>documents</strong> qui lui sont soumis. La plupart du temps un document correspond à une page web, représentée par son URL, mais cela peut aussi être un fichier ou un contenu issu d'une base de données.</p>

<ul>
<li>Nom de l'index : <code>site</code>
</li>
<li>Template : <code>Empty index</code>
</li>
</ul><p>Cliquez sur <code>Create</code>.</p>

<p>L'index est créé immédiatement. Le contexte global de l'interface change et de nouveaux onglets apparaissent en haut de page.</p>

<p>Sélectionnez l'onglet <code>Schema</code>. Le schéma permet de définir quels sont les champs de l'index. 
Un champ de schéma possède 5 propriétés :</p>

<ul>
<li>
<strong>Name</strong> : le nom du champ</li>
<li>
<strong>Indexed</strong> : indique si la valeur du champ doit être indexée, ce qui permettra alors d'effectuer des requêtes dessus. Il arrive que certains champs ne soient pas utilisés dans les recherches mais doivent tout de même être retournés (voir propriété suivante) lors d'une requête de recherche.</li>
<li>
<strong>Stored</strong> : indique si la valeur du champ doit être stockée telle quelle. Cela permettra de renvoyer la donnée brute lors d'une requête de recherche.</li>
<li>
<strong>TermVector</strong> : indique si des <code>snippets</code> pourront être configurés sur ce champ. Les snippet sont des extraits de texte contenant les mots recherchés.</li>
<li>
<strong>Analyzer</strong> : les <code>analyzers</code> sont des ensembles de filtre et de traitements automatiques qui peuvent être effectués sur les valeurs indexées. Cette fonctionnalité ne sera pas abordée durant ce tutorial. </li>
</ul><hr><p><strong>/!\ Voir pour l'utilisation exacte des analyzer : lesquels configurés sur quels champs...</strong></p>

<hr><p>Nous allons créer 4 champs pour indexer nos actualités : url, title, section (rubrique de l'actualité) et content.</p>

<p>Créez le champ url :</p>

<ul>
<li>
<strong>Name</strong> : url</li>
<li>
<strong>Indexed</strong> : yes</li>
<li>
<strong>Stored</strong> : yes</li>
<li>
<strong>TermVector</strong> : no</li>
<li>
<strong>Analyzer</strong> : laisser vide</li>
</ul><p>Cliquez sur le bouton <code>Add</code>.</p>

<p>Le champ est ajouté en dessous dans la zone <strong>List of existing fields and their settings</strong>.</p>

<p>Créez les 3 autres champs en choisissant ces  options :</p>

<ul>
<li>title :

<ul>
<li>
<strong>Name</strong> : title</li>
<li>
<strong>Indexed</strong> : yes</li>
<li>
<strong>Stored</strong> : yes</li>
<li>
<strong>TermVector</strong> : no</li>
<li>
<strong>Analyzer</strong> : laisser vide</li>
</ul>
</li>
<li>section : 

<ul>
<li>
<strong>Name</strong> : section</li>
<li>
<strong>Indexed</strong> : yes</li>
<li>
<strong>Stored</strong> : yes</li>
<li>
<strong>TermVector</strong> : no</li>
<li>
<strong>Analyzer</strong> : laisser vide</li>
</ul>
</li>
<li>content :

<ul>
<li>
<strong>Name</strong> : content</li>
<li>
<strong>Indexed</strong> : yes</li>
<li>
<strong>Stored</strong> : no</li>
<li>
<strong>TermVector</strong> : no</li>
<li>
<strong>Analyzer</strong> : laisser vide</li>
</ul>
</li>
</ul><p>Nos 4 champs sont maintenant créés et visibles dans la liste des champs.</p>

<h3>
<a name="configuration-du-crawl" class="anchor" href="#configuration-du-crawl"><span class="octicon octicon-link"></span></a>Configuration du crawl</h3>

<p>Nous devons maintenant configurer le crawler web d'OSS afin qu'il parcoure et qu'il indexe les pages désirées.</p>

<p>Rendez-vous dans l'onglet <code>Crawler</code> de l'index site. La section crawler contient deux sous navigation par onglets. Le premier des ces deux niveaux permet de choisir entre la configuration du crawler web, du crawler de base de données et du crawler de système de fichier.</p>

<p>Restons sur l'onglet <code>Web</code>. Le second niveau de navigation permet de naviguer à travers les rubriques du crawler web.</p>

<p>L'onglet sélectionné par défaut, <code>Pattern list</code>, est celui qui nous intéresse ici.</p>

<p>Le site que nous souhaitons crawler est <a href="http://xxxxxxxxxxxxxxxxx">http://xxxxxxxxxxxxxxxxx</a>. Nous pouvons voir que cette URL contient les liens vers toutes les pages d'actualités. Nous pouvons donc indiquer au crawler de commencer son crawl ici et d'indexer toutes les pages se trouvant "sous" cette URL.</p>

<p>Dans le champ de saisie de l'onglet Pattern list indiquez <code>http://xxxxxxxxxxxxx/*</code> puis cliquer sur le bouton Add. L'URL renseigné s'ajoute à la zone du dessous contenant toutes les URL à crawler.</p>

<p>La partie <code>/*</code> indique ici au crawler de parcourir toutes les pages se trouvant sous l'URL principale.</p>

<p>Rendez-vous ensuite dans l'onglet <code>Field mapping</code>. Nous allons ici configurer le crawler pour qu'il place automatiquement l'URL de la page crawlée dans le champ <code>url</code> du schéma. Le crawler peut en effet manipuler directement un certain nombre d'éléments issus de la page web crawlée, comme par exemple son url, les headers de réponses, l'url referer, etc.</p>

<p>Choisissez <code>url</code> dans les deux listes déroulantes puis cliquez sur <code>Add</code>. Le mapping entre les deux champs s'ajoute immédiatement dans la zone du dessous.</p>

<p>Voilà, nous avons configurer le crawler en 2 étapes ! Nous devons maintenant terminer la configuration du schéma avant de lancer le crawl.</p>

<h3>
<a name="configuration-finale-du-sch%C3%A9ma" class="anchor" href="#configuration-finale-du-sch%C3%A9ma"><span class="octicon octicon-link"></span></a>Configuration finale du schéma</h3>

<p>Nous allons voir rapidement comment extraire du contenu de la page HTML pour le placer automatiquement dans les champs du schéma.</p>

<p>Retournez dans l'onglet <code>Schema</code> et cliquez sur l'onglet <code>Parser list</code>. Cette page présente les différents <code>parser</code> disponibles. Cliquez sur le bouton <code>Edit</code> sur la ligne <code>HTML parser</code>. La page d'édition du parser HTML s'affiche. Cliquez sur l'onglet <code>Field mapping</code>.</p>

<hr><p><strong>/!\  Voir pour la liste par défaut : supprimer les parsers existant pour en recréer un HTML simple ?</strong></p>

<p>.......finaliser explication regexp.......</p>

<ul>
<li>extraction de la rubrique (section) de la page crawlée à partir du fil d’ariane de nos fausses pages avec une regexp</li>
<li>extraction du title</li>
<li>extraction du content</li>
</ul><hr><h3>
<a name="d%C3%A9marrage-du-crawl" class="anchor" href="#d%C3%A9marrage-du-crawl"><span class="octicon octicon-link"></span></a>Démarrage du crawl</h3>

<p>Il est maintenant temps de démarrer le crawler configuré plus tôt. Rendez-vous pour cela dans l'onglet <code>Crawler</code> puis <code>Crawl process</code>. Différents paramètres liés au crawl peuvent être réglés ici mais les valeurs par défaut sont satisfaisantes pour notre exemple. </p>

<p>Cliquez sur le bouton <code>Not running - click to run</code> afin de lancer le crawl. Ici encore, le process s'actualise immédiatement dans la zone du dessous.</p>

<p>Pendant que les pages sont crawlés et les documents ajoutés à l'index nous allons voir comment les recherches peuvent être effectuées dans ces documents.</p>

<h2>
<a name="rechercher-les-contenus-index%C3%A9s-et-personnaliser-la-pertinence-des-r%C3%A9sultats" class="anchor" href="#rechercher-les-contenus-index%C3%A9s-et-personnaliser-la-pertinence-des-r%C3%A9sultats"><span class="octicon octicon-link"></span></a>Rechercher les contenus indexés et personnaliser la pertinence des résultats</h2>

<h3>
<a name="cr%C3%A9ation-de-la-requ%C3%AAte-de-recherche-full-text" class="anchor" href="#cr%C3%A9ation-de-la-requ%C3%AAte-de-recherche-full-text"><span class="octicon octicon-link"></span></a>Création de la requête de recherche full-text</h3>

<p>Cliquez sur l'onglet <code>Query</code>. Dans le champ <code>Query name</code> saisissez <code>search_articles</code> puis cliquez sur le bouton <code>New query...</code></p>

<p>Les <code>query</code> peuvent ensuite être construites avec un formalisme puissant, mais facilement abordable. Il faut en effet indiquer au moteur de recherche dans quel champ la recherche full-text doit s'effectuer et quel poids accorder à chaque champ. </p>

<p>En effet comme nous l'avons vu au début de ce tutorial certains champs peuvent n'être que stockés mais pas indexés, car nous ne souhaitons pas effectuer de recherche dessus.
De plus nous pouvons considérer que des documents qui contiendront les mots recherchés dans leur titre ont plus de poids, et donc plus de pertinence, que les documents ne contenant ces mots que dans leur contenu.</p>

<p>Nous pouvons donc utiliser cette requête :</p>

<pre><code>title:($$)^10 OR title:("$$") OR
section:($$)^7 OR section:("$$") OR
content:($$)^4 OR content:("$$")
</code></pre>

<p><code>$$</code> représente ici le ou les mots saisis lors de la recherche.</p>

<p>Nous indiquons au moteur de rechercher d'abord dans le titre avec un poids important, puis ensuite dans la rubrique et enfin dans le contenu de l'article.</p>

<p>Nous utilisons également la notation <code>($$)</code> et <code>("$$")</code> : cela permet d'obtenir des documents contenant les mots recherchés soit de manière éclatée soit de manière regroupée.</p>

<hr><p>**/!\ Voir en fonction des analyser ce qu'il faut utiliser exactement au niveau de la recherche **</p>

<hr><p>Saisissez la requête dans le champ <code>Pattern query</code> puis cliquez sur le bouton <code>Save</code> se trouvant en haut à droite de la page.</p>

<p>Nous pouvons à présent effectuer des recherches sur les documents qui ont été indexés durant le temps de création de la requête.</p>

<p>Cliquez sur le bouton <code>Edit</code> de la requête afin de revenir à sa page d'édition. Dans le champ <code>Enter the query</code> saisissez <code>chômage</code> puis cliquez sur le bouton <code>Search</code>. Le moteur retourne les documents correspondant dans la zone du dessous. </p>

<h2>
<a name="proposer-une-page-de-recherche-aux-utilisateurs" class="anchor" href="#proposer-une-page-de-recherche-aux-utilisateurs"><span class="octicon octicon-link"></span></a>Proposer une page de recherche aux utilisateurs</h2>

<h2>
<a name="ajout-dune-facette" class="anchor" href="#ajout-dune-facette"><span class="octicon octicon-link"></span></a>Ajout d’une facette</h2>

<h2>
<a name="ajout-de-lautocompl%C3%A9tion" class="anchor" href="#ajout-de-lautocompl%C3%A9tion"><span class="octicon octicon-link"></span></a>Ajout de l’autocomplétion</h2>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Test maintained by <a href="https://github.com/AlexandreToyer">AlexandreToyer</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
